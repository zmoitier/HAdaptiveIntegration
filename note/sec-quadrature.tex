% !TeX root = main.tex
% LTeX: language=en-US

%***===========================================================
\section{Embedded cubature rule}

For \( \Omega \) an open domain in \( \mathbb{R}^n \), mainly the interior of the reference simplex \( \Simplex_\Rf \) or reference orthotope \( \Orthotope_\Rf \).
An embedded cubature \( \Quad = \plr{\Quad_\lo, \Quad_\hi} \) is composed of two nested cubature rules, one of low order \( \Quad_\lo = \plr{\calX_\lo, \vec{w}_\lo} \) and one of high order \( \Quad_\hi = \plr{\calX_\hi, \vec{w}_\hi} \) where
\[
    \calX_\lo \coloneqq \blr*{x_1, \ldots, x_{N_\lo}}
    \subset \calX_\hi \coloneqq \blr*{x_1, \ldots, x_{N_\lo}, \ldots, x_{N_\hi}}
    \subset K
\]
are sets of points with \( 1 \leq N_\lo < N_\hi \) and
\[
    \vec{w}_\lo \coloneqq \plr*{w_1^\lo, \ldots, w_{N_\lo}^\lo}
    \quad \text{and} \quad
    \vec{w}_\hi \coloneqq \plr*{w_1^\hi, \ldots, w_{N_\hi}^\hi}
\]
are the corresponding weights.
In addition, we assume that the order of the low order cubature rule is \( d_\lo \) and the order of the high order cubature rule is \( d_\hi \) with \( d_\lo < d_\hi \).
For a continuous function \( f \in \spC\plr{\Omega} \), an embedded cubature rule is used to give an approximation \( \Quad\clr{f} \) of the integral of a function \( f \) over \( \Omega \) and give error estimate \( \Err\clr{f} \) of the approximation by
\[
    \Quad\clr{f} \coloneqq \Quad_\hi\clr{f} \approx \int_\Omega f\plr{x} \di{x}
    \qquad \text{and} \qquad
    \Err\clr{f} \coloneqq \abs*{\Quad_\hi\clr{f} - \Quad_\lo\clr{f}},
\]
where
\[
    \Quad_\lo\clr{f} \coloneqq \sum_{i=1}^{N_\lo} w_i^\lo f\plr*{x_i}
    \quad \text{and} \quad
    \Quad_\hi\clr{f} \coloneqq \sum_{i=1}^{N_\hi} w_i^\hi f\plr*{x_i}.
\]

\begin{align*}
    \mathbb{E}_\lo & \coloneqq \setst*{p \in \spPolyP}{\Quad_\lo\clr{p} = \int_\Omega p\plr{x} \di{x}} \supset \spPolyP[d_\lo],
    \\
    \mathbb{E}_\hi & \coloneqq \setst*{p \in \spPolyP}{\Quad_\hi\clr{p} = \int_\Omega p\plr{x} \di{x}} \supset \spPolyP[d_\hi].
\end{align*}
